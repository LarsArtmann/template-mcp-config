%% Current MCP Configuration Architecture (PROBLEMS HIGHLIGHTED)
%% This diagram shows why our current architecture SUCKS

graph TD
    %% Configuration Layer - MONOLITHIC MESS
    subgraph Config["âš ï¸ CONFIGURATION CHAOS"]
        MCP[".mcp.json<br/>ğŸ’€ 15 servers hardcoded<br/>ğŸ’€ No validation rules<br/>ğŸ’€ Environment variables embedded"]
        ENV[".env<br/>ğŸ’€ Mixed concerns<br/>ğŸ’€ No type safety<br/>ğŸ’€ Placeholder values"]
        PKG["package.json<br/>ğŸ’€ 73 scripts<br/>ğŸ’€ Duplicate functionality<br/>ğŸ’€ No clear boundaries"]
    end

    %% Validation Hell - GOD OBJECT
    subgraph Validation["ğŸ”¥ VALIDATION HELL"]
        ValidateJS["validate-config.js<br/>ğŸ’€ 609 lines GOD OBJECT<br/>ğŸ’€ Does EVERYTHING<br/>ğŸ’€ Structure + Env + Network + Logic<br/>ğŸ’€ No separation of concerns"]
        ValidateEnv["validate-env.js<br/>ğŸ’€ Duplicate validation logic<br/>ğŸ’€ Copy-paste programming"]
        TestValidation["test-validation.js<br/>ğŸ’€ More duplication<br/>ğŸ’€ Inconsistent with main validator"]
    end

    %% Testing Disaster - ANOTHER MONOLITH
    subgraph Testing["ğŸ’¥ TESTING DISASTER"]
        TestServers["test-servers.js<br/>ğŸ’€ 462 lines MONOLITH<br/>ğŸ’€ Mix of unit/integration/e2e<br/>ğŸ’€ No test separation<br/>ğŸ’€ Hardcoded server logic"]
        TestMCP["test-mcp-servers.js<br/>ğŸ’€ DUPLICATE test logic<br/>ğŸ’€ Different implementation<br/>ğŸ’€ Inconsistent results"]
        ComprehensiveTest["comprehensive-test-servers.js<br/>ğŸ’€ ANOTHER duplicate<br/>ğŸ’€ Same functionality, different approach"]
    end

    %% Scripts Chaos - SPAGHETTI HELL
    subgraph Scripts["ğŸŒ€ SCRIPTS SPAGHETTI"]
        HealthCheck["health-check.js"]
        ParallelHealth["parallel-health-check.js<br/>ğŸ’€ Duplicate health logic"]
        Benchmark["benchmark-performance.js"]
        PerfSummary["performance-summary.js"]
        Setup["setup.js"]
        WarmCache["warm-cache.js"]
    end

    %% Ghost Systems - UNUSED COMPLEXITY
    subgraph Ghost["ğŸ‘» GHOST SYSTEMS"]
        TypeSpec["schemas/main.tsp<br/>ğŸ’€ 452 lines UNUSED<br/>ğŸ’€ Perfect type definitions<br/>ğŸ’€ Generated schemas IGNORED<br/>ğŸ’€ Zero integration"]
        Generated["schemas/generated/<br/>ğŸ’€ Auto-generated schemas<br/>ğŸ’€ NEVER USED<br/>ğŸ’€ Wasted automation"]
    end

    %% Justfile - DUPLICATE ORCHESTRATION
    subgraph Just["ğŸ”„ DUPLICATE ORCHESTRATION"]
        Justfile["justfile<br/>ğŸ’€ 108 lines<br/>ğŸ’€ Duplicates package.json scripts<br/>ğŸ’€ Two ways to do everything<br/>ğŸ’€ No single source of truth"]
    end

    %% Problem Connections (RED = BAD)
    Config --> Validation
    Config --> Testing
    Config --> Scripts
    
    ValidateJS -.->|"ğŸ’€ DUPLICATES"| ValidateEnv
    ValidateJS -.->|"ğŸ’€ DUPLICATES"| TestValidation
    
    TestServers -.->|"ğŸ’€ DUPLICATES"| TestMCP
    TestMCP -.->|"ğŸ’€ DUPLICATES"| ComprehensiveTest
    
    HealthCheck -.->|"ğŸ’€ DUPLICATES"| ParallelHealth
    
    TypeSpec -.->|"ğŸ’€ NEVER USED"| Generated
    Generated -.->|"ğŸ’€ IGNORED BY"| ValidateJS
    Generated -.->|"ğŸ’€ IGNORED BY"| TestServers
    
    PKG -.->|"ğŸ’€ DUPLICATES"| Justfile

    %% Key Problems Legend
    subgraph Problems["ğŸš¨ ARCHITECTURAL SINS"]
        P1["ğŸ’€ GOD OBJECTS: validate-config.js (609 lines)"]
        P2["ğŸ’€ DUPLICATION: 4+ validation scripts"]
        P3["ğŸ’€ GHOST CODE: TypeSpec schemas unused"]
        P4["ğŸ’€ NO SEPARATION: Everything mixed together"]
        P5["ğŸ’€ NO TYPES: Runtime validation only"]
        P6["ğŸ’€ SPAGHETTI: No clear data flow"]
    end

    %% Style the problems
    classDef problemNode fill:#ff6b6b,stroke:#d63031,stroke-width:3px,color:#fff
    classDef ghostNode fill:#6c5ce7,stroke:#5f3dc4,stroke-width:2px,color:#fff
    classDef duplicateEdge stroke:#ff6b6b,stroke-width:3px,stroke-dasharray:10,5
    
    class Config,Validation,Testing,Scripts problemNode
    class Ghost,TypeSpec,Generated ghostNode